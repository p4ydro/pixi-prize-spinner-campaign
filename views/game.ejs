<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Via Spinner</title>

    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">
    <link rel="stylesheet" href="stylesheets/fonts.css">
    <link rel="stylesheet" href="stylesheets/style.css">
    <link rel="stylesheet" href="stylesheets/game.css">
    <script src="code/tink.js"></script>
    <script src="code/pixi.js"></script>
    <script src="code/jquery-3.3.1.min.js"></script>
    <script src="code/Utils/DisableScroll.js"></script>

    <link rel="icon" href="images/favicon.ico">
</head>
<body>

    <noscript>
        <div class="noscript">You must enable JavaScript in your browser settings in order to participate in this game.</div>
    </noscript>

    <div class="background-holder">
        <img src="images/Game/Icons.png" alt="" class="background-icons">
        <img src="images/Game/Background-Overlay.png" alt="" class="background-top-overlay">
        <img src="images/Game/Background-Bottom.png" alt="" class="background-bottom-piece">
    </div>

    <div class="loading-overlay">
        <div class="text-section">
            <h1 class="loading-text">
                <i class="fas fa-spinner loading-icon fa-spin"></i>
                Loading...
            </h1>
        </div>
    </div>

    <div id="main">

        <div class="game-overlay">
            <div class="button-section">
                <button class="spin-button">Spin</button>
                <div class="spin-text">
                    <h2 class="seconds-text">Prizes are seconds away...</h2>
                    <h2 class="spinning-text">Spinning...</h2>
                </div>
            </div>
        </div>

        <div class="darkener"></div>
        
        <div class="prize-iframe-container">
            <iframe src="" frameborder="0" class="prize-iframe" div="prize-iframe" allowtransparency="true">
                <style>
                    body
                    {
                        background:none transparent !important;
                    }
                </style>
            </iframe>
        </div>
    </div>

    <script>
        $(document).ready(function() {
            // Prize frame
            var prizeFrame = $('iframe');
            // Initialize prize frame with source
            prizeFrame.attr("src", "/prizeprompt");
        });


        $('iframe').on('load', function() {
            console.log("RE")
            resizePrizeFrameWithContent($(this));
            // setTimeout(function() {
            //     resizePrizeFrameWithContent($(this))
            // }, 1000);
        });

        function resizePrizeFrameWithContent(passedPrizeFrame) {
            let prizeFrameDocument = document.querySelector('iframe').contentWindow;
            
            passedPrizeFrame.css({
                height: prizeFrameDocument.$("body").outerHeight()
            });
        }
        // var prizeFrameIsReady = false;

        // function setPrizeFrameReady() {
        //     prizeFrameIsReady = true;
        // }
        // $(document).on('prizeFrameReady', setPrizeFrameReady);
    </script>

    <script data-main="code/Main.js" src="requirejs/require.js"></script>

</body>
</html>